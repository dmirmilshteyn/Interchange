language: csharp

sudo: required
dist: trusty

mono:
 - beta
 
before_install:
  - sudo apt-get -qq update
  - sudo apt-get install -y libunwind8-dev

install: 
- sudo sh -c 'echo "deb [arch=amd64] https://apt-mo.trafficmanager.net/repos/dotnet/ trusty main" > /etc/apt/sources.list.d/dotnetdev.list'
- sudo apt-key adv --keyserver apt-mo.trafficmanager.net --recv-keys 417A0893
- sudo apt-get update
- sudo apt-get install dotnet-dev-1.0.0-preview1-002702

script:
 - build_num=$TRAVIS_BUILD_NUMBER
 - build_num=$(printf "%.4d" "$build_num")
 - export DOTNET_BUILD_VERSION=$build_num
 - dotnet restore
 - cd tests
 - dotnet test
 - cd ../src/Interchange
 - dotnet pack --configuration Release
 - cd bin/Release
 - nuget push *.nupkg -ApiKey "$API_KEY" -Source "$FEED_URL"